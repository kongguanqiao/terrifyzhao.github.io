---
layout: post
title: '贝叶斯网络'
subtitle: ''
date: 2018-03-06
categories: 机器学习
cover: 'https://raw.githubusercontent.com/terrifyzhao/terrifyzhao.github.io/master/assets/img/2018-03-01-SVM/cover.jpeg'
tags: 机器学习
---

## 条件概率

条件概率是指事件A在另外一个事件B已经发生条件下的发生概率。条件概率表示为：P（A|B），读作“在B条件下A的概率”。

$$P(AB) = P(A)P(B|A)$$

## 全概率公式

在讲全概率公式之前，首先要理解什么是“完备事件群”。 
我们将满足 

$$\sum_{i=1}^n B_i = 1$$

如果A是未知事件，那么

$$A = \sum_{i=1}^n AB_i$$

$$P(A) = \sum_{i=1}^n P(AB_i)$$

根据条件概率有

$$P(A) = \sum_{i=1}^n P(B_i)P(A|B_i)$$

下面我们来举一个例子。 
某地盗窃风气盛行，且偷窃者屡教不改。我们根据过往的案件记录，推断A今晚作案的概率是0.8，B今晚作案的概率是0.1，C今晚作案的概率是0.5，除此之外，还推断出A的得手率是0.1，B的得手率是1.0，C的得手率是0.5。那么，今晚村里有东西被偷的概率是多少？ 
通过阅读上述文字，我们大概对A、B、C三人有了一个初步的印象。首先，A的脑子可能有些问题，特别喜欢偷，但是技术相当烂。B看来是个江湖高手，一般不出手，一出手就绝不失手。C大概是追求中庸，各方面都很普通。 
我们将文字描述转换为数学语言，根据作案频率可知 

$$P(A)=0.8,P(B)=0.1,P(C)=0.5$$

将“村里有东西被偷”记为S，根据得手率可以得到 

$$P(S|A)=0.1,P(S|B)=1.0,P(S|C)=0.5$$

很简单，所求得的就是 

$$P(S)=P(A)P(S|A)+P(B)P(S|B)+P(C)P(S|C)=0.43$$

祝这个村晚上好运吧。

## 贝叶斯公式

有了前面的基础，我们现在先直接抛出贝叶斯公式： 

$$P(B_i|A) = \frac{P(AB_i)}{P(A)} = \frac{p(B_i)P(A|B_i)}{\sum_{j} P(B_j)P(A|B_j)}$$

举个例子： 
假设某种病菌在人口中的带菌率为0.03，由于技术落后等等原因，使得带菌者有时也未被检出阳性反应（假阴性），不带菌者也可能会被检出阳性反应（假阳性）。有如下数据： 

$$P(阳性|带菌)=0.99,P(阴性|带菌)=0.01,P(阳性|不带菌)=0.05,P(阴性|不带菌)=0.95$$
假如一个人被检出阳性，那么这个人带菌的概率是多少？

如果不用概率的思维，光凭感觉去想这个问题……误检率那么低，那这个带菌的可能性大概会很高吧？ 
我们用贝叶斯公式去实际计算一下。 

$$
\begin{align}
P(带菌|阳性)&=\frac{P(带菌)P(阳性|带菌)}{P(带菌)P(阳性|带菌)+P(不带菌)P(阳性|不带菌)}\\ &=\frac{0.03×0.99}{0.03×0.99+0.97×0.05}\\
&=0.38
\end{align}
$$

结果竟然连40%都没到。 
问题出在哪里？我们没有注意到，带菌率低到只有0.03，甚至比误检率还要低。也就是说，在一大批人里可以检查出一堆阳性的，而这堆阳性的人里面真正带菌的，也只是一小部分而已。

## 贝叶斯网络
联合分布

在图模型中，除了父节点与子节点外的其他节点都是相互独立的，这些相互独立的节点在计算的时候可以直接约掉


