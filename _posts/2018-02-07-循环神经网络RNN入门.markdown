---
layout: post
title: '循环神经网络RNN入门'
subtitle: 'RNN基础讲解'
date: 2018-02-07
categories: 神经网络
cover: ''
tags: 机器学习 神经网络
---


## 1、为什么需要循环神经网络

普通的神经网络只能对单一时刻的数据就行处理，但是，当任务需要处理序列信息时，例如一段文字，音频，视频，即前面的输入与后面的输入是有关联的。

举个例子：现在我们要对“我爱你”与“这就是爱”中的“爱”字进行词性分析，在不同的语境下，爱的词性是不同的，在前一句中是动词，后一句中是名词，如果用普通的神经网络进行识别，是无法准确判断的。在词性判断中，前一个词会对后一个词的词性判断产生很大的影响，在“这就是爱”这种文字中，“是“是一个动词，那么“爱”是名词的概率就会大大提高，因为动词后面一般接名词，而动词后接动词就很少见。

显然，普通的神经网路无法建立前后关系，为了能更好的处理序列信息，循环神经网络就诞生了。

## 2、循环神经网络结构

RNN听名字，看似很复杂，但相对于CNN来说，结构反而简单许多。

我们先从一个简单的浅层神经网络说起
<img src="https://raw.githubusercontent.com/terrifyzhao/terrifyzhao.github.io/master/assets/img/2018-02-07-%E5%BE%AA%E7%8E%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CRNN%E5%85%A5%E9%97%A8/rnn_1.jpg" width = "100" height = "210" alt="图片名称"/>

这是一个最简单的神经网络模型，x为输入，h是隐藏层，y是输出层，U与V是我们需要学习的参数。公式如下：

隐藏层:

h = f(x*U+bias)

输出层:

y = f(h*V+bias2)


我们再来看看RNN的结构
<img src="https://raw.githubusercontent.com/terrifyzhao/terrifyzhao.github.io/master/assets/img/2018-02-07-%E5%BE%AA%E7%8E%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CRNN%E5%85%A5%E9%97%A8/rnn_2.jpg" width = "100" height = "210" alt="图片名称"/>
RNN的结构和浅层神经网络很类似，唯一的区别是在隐藏层，多了一个递归的圈，同时这个圈带着一个W参数，接下来我们把该圈展开看一看
<img src="https://raw.githubusercontent.com/terrifyzhao/terrifyzhao.github.io/master/assets/img/2018-02-07-%E5%BE%AA%E7%8E%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CRNN%E5%85%A5%E9%97%A8/rnn_3.jpg" width = "600" height = "210" alt="图片名称"/>
展开后可以看到隐藏层h的输入变为了2个部分，我们以中间的h<sub>t</sub>为例，此时公式为:

隐藏层:

h<sub>t</sub> = f(U * x<sub>t</sub> + W * h<sub>t-1</sub> + bias1)

输出层:

y<sub>t</sub> = f(V * h<sub>t</sub> + bias2)

是不是和浅层神经网络很像，只是在计算隐藏层的时候多了一项，隐藏层的值不仅仅取决于当前这次的输入x，还取决于上一次隐藏层的值h。权重矩阵W就是隐藏层上一次的值作为这一次的输入的权重。

## 3、总结
循环神经网络（recurrent neural network，RNN）源自于1982年由Saratha Sathasivam提出的霍普菲尔德网络。霍普菲尔德网络因为实现困难，在其提出的时候并且没有被合适地应用。该网络结构也于1986年后被全连接神经网络以及一些传统的机器学习算法所取代。然而，传统的机器学习算法非常依赖于人工提取的特征，使得基于传统机器学习的图像识别、语音识别以及自然语言处理等问题存在特征提取的瓶颈。而基于全连接神经网络的方法也存在参数太多、无法利用数据中时间序列信息等问题。随着更加有效的循环神经网络结构被不断提出，循环神经网络挖掘数据中的时序信息以及语义信息的深度表达能力被充分利用，并在语音识别、语言模型、机器翻译以及时序分析等方面实现了突破。

好了，到这里大概讲解了RNN最基本的几个知识点，能够帮助大家直观的感受RNN和了解为什么需要RNN。下一篇博客[循环神经网络RNN进阶
](https://terrifyzhao.github.io/2018/02/13/%E5%BE%AA%E7%8E%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CRNN%E8%BF%9B%E9%98%B6.html)将会为大家介绍RNN的进阶内容。



